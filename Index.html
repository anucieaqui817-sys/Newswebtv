<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Multi-Editor</title>
    <style>
        :root { --bg: #1e1e1e; --panel: #2d2d2d; --text: #d4d4d4; --accent: #007acc; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; height: 100vh; }
        
        /* Toolbar */
        .toolbar { background: var(--panel); padding: 10px; display: flex; gap: 8px; overflow-x: auto; border-bottom: 1px solid #333; }
        button, label { background: var(--accent); border: none; padding: 8px 12px; border-radius: 4px; color: white; font-size: 14px; cursor: pointer; white-space: nowrap; }
        input[type="file"] { display: none; }

        /* Área do Editor */
        #editor { flex: 1; width: 100%; background: transparent; color: #9cdcfe; border: none; padding: 15px; box-sizing: border-box; font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; resize: none; outline: none; }
        
        .file-info { background: #333; padding: 5px 15px; font-size: 12px; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

    <div class="toolbar">
        <label for="fileInput">Abrir Arquivo</label>
        <input type="file" id="fileInput" accept=".txt,.m3u,.bin">
        <button onclick="saveFile()">Salvar</button>
        <button onclick="location.reload()">Novo</button>
    </div>

    <div class="file-info">
        <span id="fileName">Nenhum arquivo aberto</span>
        <span id="fileType">-</span>
    </div>

    <textarea id="editor" placeholder="O conteúdo do arquivo aparecerá aqui..."></textarea>

    <script>
        const fileInput = document.getElementById('fileInput');
        const editor = document.getElementById('editor');
        const fileNameDisplay = document.getElementById('fileName');
        const fileTypeDisplay = document.getElementById('fileType');

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            fileNameDisplay.innerText = file.name;
            fileTypeDisplay.innerText = file.name.split('.').pop().toUpperCase();

            // Lógica para arquivos binários (.bin)
            if (file.name.endsWith('.bin')) {
                reader.onload = function(e) {
                    const buffer = e.target.result;
                    const uint8View = new Uint8Array(buffer);
                    let hexString = "";
                    for (let i = 0; i < Math.min(uint8View.length, 5000); i++) { // Limite para não travar
                        hexString += uint8View[i].toString(16).padStart(2, '0') + " ";
                        if ((i + 1) % 16 === 0) hexString += "\n";
                    }
                    editor.value = hexString.toUpperCase();
                };
                reader.readAsArrayBuffer(file);
            } 
            // Lógica para texto (.txt, .m3u)
            else {
                reader.onload = function(e) {
                    editor.value = e.target.result;
                };
                reader.readAsText(file);
            }
        });

        function saveFile() {
            const blob = new Blob([editor.value], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = fileNameDisplay.innerText.includes('.') ? fileNameDisplay.innerText : "arquivo_editado.txt";
            link.click();
        }
    </script>
</body>
</html>
